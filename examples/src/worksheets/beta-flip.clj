;; gorilla-repl.fileformat = 1

;; **
;;; # Beta-Flip
;; **

;; @@
(ns worksheets.beta-flip
  (:require [anglican.runtime :refer :all]
            [anglican.emit :refer :all]
            [anglican.stat :as stat]
            [anglican.infcomp.zmq :as zmq]
            [anglican.inference :refer [infer]]
            [anglican.infcomp.prior :as prior]
            [gorilla-plot.core :as plt]
            anglican.infcomp.csis
            anglican.importance
            anglican.infcomp.core))

(anglican.infcomp.core/reset-infcomp-addressing-scheme!)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-unkown'>#function[anglican.infcomp.core/reset-infcomp-addressing-scheme!$fn--26877$fn--26878]</span>","value":"#function[anglican.infcomp.core/reset-infcomp-addressing-scheme!$fn--26877$fn--26878]"}
;; <=

;; **
;;; ## Model
;; **

;; @@
(def prior-alpha 2)
(def prior-beta 5)

(defquery beta-flip [observations]
  (let [prob (sample (beta prior-alpha prior-beta))]
    (doall (map #(observe (flip prob) %) observations))
    prob))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;worksheets.beta-flip/beta-flip</span>","value":"#'worksheets.beta-flip/beta-flip"}
;; <=

;; **
;;; ## Inference Compilation
;; **

;; @@
(defn combine-observes-fn [observes]
  (map :value observes))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;worksheets.beta-flip/combine-observes-fn</span>","value":"#'worksheets.beta-flip/combine-observes-fn"}
;; <=

;; @@
(prior/sample-observes-from-prior beta-flip [(repeat 10 nil)])
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:time-index</span>","value":":time-index"},{"type":"html","content":"<span class='clj-unkown'>0</span>","value":"0"}],"value":"[:time-index 0]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-address</span>","value":":observe-address"},{"type":"html","content":"<span class='clj-symbol'>O8</span>","value":"O8"}],"value":"[:observe-address O8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-instance</span>","value":":observe-instance"},{"type":"html","content":"<span class='clj-unkown'>0</span>","value":"0"}],"value":"[:observe-instance 0]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:value</span>","value":":value"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"}],"value":"[:value 0]"}],"value":"{:time-index 0, :observe-address O8, :observe-instance 0, :value 0}"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:time-index</span>","value":":time-index"},{"type":"html","content":"<span class='clj-unkown'>1</span>","value":"1"}],"value":"[:time-index 1]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-address</span>","value":":observe-address"},{"type":"html","content":"<span class='clj-symbol'>O8</span>","value":"O8"}],"value":"[:observe-address O8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-instance</span>","value":":observe-instance"},{"type":"html","content":"<span class='clj-unkown'>1</span>","value":"1"}],"value":"[:observe-instance 1]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:value</span>","value":":value"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"}],"value":"[:value 0]"}],"value":"{:time-index 1, :observe-address O8, :observe-instance 1, :value 0}"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:time-index</span>","value":":time-index"},{"type":"html","content":"<span class='clj-unkown'>2</span>","value":"2"}],"value":"[:time-index 2]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-address</span>","value":":observe-address"},{"type":"html","content":"<span class='clj-symbol'>O8</span>","value":"O8"}],"value":"[:observe-address O8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-instance</span>","value":":observe-instance"},{"type":"html","content":"<span class='clj-unkown'>2</span>","value":"2"}],"value":"[:observe-instance 2]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:value</span>","value":":value"},{"type":"html","content":"<span class='clj-long'>1</span>","value":"1"}],"value":"[:value 1]"}],"value":"{:time-index 2, :observe-address O8, :observe-instance 2, :value 1}"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:time-index</span>","value":":time-index"},{"type":"html","content":"<span class='clj-unkown'>3</span>","value":"3"}],"value":"[:time-index 3]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-address</span>","value":":observe-address"},{"type":"html","content":"<span class='clj-symbol'>O8</span>","value":"O8"}],"value":"[:observe-address O8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-instance</span>","value":":observe-instance"},{"type":"html","content":"<span class='clj-unkown'>3</span>","value":"3"}],"value":"[:observe-instance 3]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:value</span>","value":":value"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"}],"value":"[:value 0]"}],"value":"{:time-index 3, :observe-address O8, :observe-instance 3, :value 0}"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:time-index</span>","value":":time-index"},{"type":"html","content":"<span class='clj-unkown'>4</span>","value":"4"}],"value":"[:time-index 4]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-address</span>","value":":observe-address"},{"type":"html","content":"<span class='clj-symbol'>O8</span>","value":"O8"}],"value":"[:observe-address O8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-instance</span>","value":":observe-instance"},{"type":"html","content":"<span class='clj-unkown'>4</span>","value":"4"}],"value":"[:observe-instance 4]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:value</span>","value":":value"},{"type":"html","content":"<span class='clj-long'>1</span>","value":"1"}],"value":"[:value 1]"}],"value":"{:time-index 4, :observe-address O8, :observe-instance 4, :value 1}"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:time-index</span>","value":":time-index"},{"type":"html","content":"<span class='clj-unkown'>5</span>","value":"5"}],"value":"[:time-index 5]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-address</span>","value":":observe-address"},{"type":"html","content":"<span class='clj-symbol'>O8</span>","value":"O8"}],"value":"[:observe-address O8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-instance</span>","value":":observe-instance"},{"type":"html","content":"<span class='clj-unkown'>5</span>","value":"5"}],"value":"[:observe-instance 5]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:value</span>","value":":value"},{"type":"html","content":"<span class='clj-long'>1</span>","value":"1"}],"value":"[:value 1]"}],"value":"{:time-index 5, :observe-address O8, :observe-instance 5, :value 1}"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:time-index</span>","value":":time-index"},{"type":"html","content":"<span class='clj-unkown'>6</span>","value":"6"}],"value":"[:time-index 6]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-address</span>","value":":observe-address"},{"type":"html","content":"<span class='clj-symbol'>O8</span>","value":"O8"}],"value":"[:observe-address O8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-instance</span>","value":":observe-instance"},{"type":"html","content":"<span class='clj-unkown'>6</span>","value":"6"}],"value":"[:observe-instance 6]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:value</span>","value":":value"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"}],"value":"[:value 0]"}],"value":"{:time-index 6, :observe-address O8, :observe-instance 6, :value 0}"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:time-index</span>","value":":time-index"},{"type":"html","content":"<span class='clj-unkown'>7</span>","value":"7"}],"value":"[:time-index 7]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-address</span>","value":":observe-address"},{"type":"html","content":"<span class='clj-symbol'>O8</span>","value":"O8"}],"value":"[:observe-address O8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-instance</span>","value":":observe-instance"},{"type":"html","content":"<span class='clj-unkown'>7</span>","value":"7"}],"value":"[:observe-instance 7]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:value</span>","value":":value"},{"type":"html","content":"<span class='clj-long'>0</span>","value":"0"}],"value":"[:value 0]"}],"value":"{:time-index 7, :observe-address O8, :observe-instance 7, :value 0}"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:time-index</span>","value":":time-index"},{"type":"html","content":"<span class='clj-unkown'>8</span>","value":"8"}],"value":"[:time-index 8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-address</span>","value":":observe-address"},{"type":"html","content":"<span class='clj-symbol'>O8</span>","value":"O8"}],"value":"[:observe-address O8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-instance</span>","value":":observe-instance"},{"type":"html","content":"<span class='clj-unkown'>8</span>","value":"8"}],"value":"[:observe-instance 8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:value</span>","value":":value"},{"type":"html","content":"<span class='clj-long'>1</span>","value":"1"}],"value":"[:value 1]"}],"value":"{:time-index 8, :observe-address O8, :observe-instance 8, :value 1}"},{"type":"list-like","open":"<span class='clj-map'>{</span>","close":"<span class='clj-map'>}</span>","separator":", ","items":[{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:time-index</span>","value":":time-index"},{"type":"html","content":"<span class='clj-unkown'>9</span>","value":"9"}],"value":"[:time-index 9]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-address</span>","value":":observe-address"},{"type":"html","content":"<span class='clj-symbol'>O8</span>","value":"O8"}],"value":"[:observe-address O8]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:observe-instance</span>","value":":observe-instance"},{"type":"html","content":"<span class='clj-unkown'>9</span>","value":"9"}],"value":"[:observe-instance 9]"},{"type":"list-like","open":"","close":"","separator":" ","items":[{"type":"html","content":"<span class='clj-keyword'>:value</span>","value":":value"},{"type":"html","content":"<span class='clj-long'>1</span>","value":"1"}],"value":"[:value 1]"}],"value":"{:time-index 9, :observe-address O8, :observe-instance 9, :value 1}"}],"value":"[{:time-index 0, :observe-address O8, :observe-instance 0, :value 0} {:time-index 1, :observe-address O8, :observe-instance 1, :value 0} {:time-index 2, :observe-address O8, :observe-instance 2, :value 1} {:time-index 3, :observe-address O8, :observe-instance 3, :value 0} {:time-index 4, :observe-address O8, :observe-instance 4, :value 1} {:time-index 5, :observe-address O8, :observe-instance 5, :value 1} {:time-index 6, :observe-address O8, :observe-instance 6, :value 0} {:time-index 7, :observe-address O8, :observe-instance 7, :value 0} {:time-index 8, :observe-address O8, :observe-instance 8, :value 1} {:time-index 9, :observe-address O8, :observe-instance 9, :value 1}]"}
;; <=

;; @@
(def replier (zmq/start-replier beta-flip [(repeat 10 nil)] combine-observes-fn))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;worksheets.beta-flip/replier</span>","value":"#'worksheets.beta-flip/replier"}
;; <=

;; @@
(zmq/stop-replier replier)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-string'>&quot;ZMQ connection terminated.&quot;</span>","value":"\"ZMQ connection terminated.\""}
;; <=

;; **
;;; ## Inference
;; **

;; @@
(def num-true 8)
(def num-false 2)
(def test-observations (shuffle (concat (repeat num-true true) (repeat num-false false))))
(def posterior-plot (plt/plot #(Math/exp (observe* (beta (+ prior-alpha num-true) (+ prior-beta num-false)) %)) [0 1]))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;worksheets.beta-flip/posterior-plot</span>","value":"#'worksheets.beta-flip/posterior-plot"}
;; <=

;; @@
(def num-particles 20)
(def csis-states (take num-particles (infer :csis beta-flip [test-observations] :observe-embedder-input (map #(if % 1 0) test-observations))))
(plt/compose
  posterior-plot
  (plt/histogram (repeatedly 10000 #(sample* (categorical (vec (stat/empirical-distribution (stat/collect-results csis-states)))))) :plot-range [[0 1] :all] :normalize :probability-density))
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"top":10,"left":55,"bottom":40,"right":10},"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"3d8f9732-0260-4187-ae70-2895b47c6b91","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"3d8f9732-0260-4187-ae70-2895b47c6b91","field":"data.y"}}],"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}],"data":[{"name":"3d8f9732-0260-4187-ae70-2895b47c6b91","values":[{"x":0,"y":0.0},{"x":0.009999999776482582,"y":7.539371529953434E-14},{"x":0.019999999552965164,"y":3.632038081710175E-11},{"x":0.029999999329447746,"y":1.312942410206015E-9},{"x":0.03999999910593033,"y":1.6432033048666994E-8},{"x":0.04999999888241291,"y":1.149729437009842E-7},{"x":0.05999999865889549,"y":5.567399112490165E-7},{"x":0.06999999843537807,"y":2.0907592791841455E-6},{"x":0.07999999821186066,"y":6.517196703563322E-6},{"x":0.08999999798834324,"y":1.7617931689323155E-5},{"x":0.09999999776482582,"y":4.2557787352993526E-5},{"x":0.1099999975413084,"y":9.384220214797907E-5},{"x":0.11999999731779099,"y":1.9188950934436485E-4},{"x":0.12999999709427357,"y":3.6823890654172673E-4},{"x":0.13999999687075615,"y":6.69371188358415E-4},{"x":0.14999999664723873,"y":0.0011610712548425525},{"x":0.1599999964237213,"y":0.00193321229472357},{"x":0.1699999962002039,"y":0.0031047943233924453},{"x":0.17999999597668648,"y":0.004829027183399602},{"x":0.18999999575316906,"y":0.007298212637337675},{"x":0.19999999552965164,"y":0.010748153856440106},{"x":0.20999999530613422,"y":0.015461805041620348},{"x":0.2199999950826168,"y":0.021771870230572168},{"x":0.2299999948590994,"y":0.030062069167227316},{"x":0.23999999463558197,"y":0.040766809560579466},{"x":0.24999999441206455,"y":0.05436903877742644},{"x":0.25999999418854713,"y":0.0713960931829195},{"x":0.2699999939650297,"y":0.09241341873570566},{"x":0.2799999937415123,"y":0.11801610046911065},{"x":0.2899999935179949,"y":0.14881820924762124},{"x":0.29999999329447746,"y":0.18544004953551946},{"x":0.30999999307096004,"y":0.2284934695295775},{"x":0.3199999928474426,"y":0.27856547245668084},{"x":0.3299999926239252,"y":0.33620044264396637},{"x":0.3399999924004078,"y":0.4018813696822282},{"x":0.3499999921768904,"y":0.4760105162626121},{"x":0.35999999195337296,"y":0.5588900278646792},{"x":0.36999999172985554,"y":0.6507030234154363},{"x":0.3799999915063381,"y":0.7514957335932372},{"x":0.3899999912828207,"y":0.8611612661993497},{"x":0.3999999910593033,"y":0.9794255748977719},{"x":0.40999999083578587,"y":1.1058361879511303},{"x":0.41999999061226845,"y":1.2397542170890021},{"x":0.42999999038875103,"y":1.3803501134949525},{"x":0.4399999901652336,"y":1.5266035686874704},{"x":0.4499999899417162,"y":1.6773078738314677},{"x":0.4599999897181988,"y":1.831078953212661},{"x":0.46999998949468136,"y":1.9863691781078412},{"x":0.47999998927116394,"y":2.1414859483424555},{"x":0.4899999890476465,"y":2.294614903043911},{"x":0.4999999888241291,"y":2.443847492377241},{"x":0.5099999886006117,"y":2.587212511544168},{"x":0.5199999883770943,"y":2.7227110703849355},{"x":0.5299999881535769,"y":2.8483543500177806},{"x":0.5399999879300594,"y":2.9622033856139547},{"x":0.549999987706542,"y":3.062410015143814},{"x":0.5599999874830246,"y":3.1472580511471233},{"x":0.5699999872595072,"y":3.2152036694964807},{"x":0.5799999870359898,"y":3.2649139686831417},{"x":0.5899999868124723,"y":3.2953026379436374},{"x":0.5999999865889549,"y":3.305561684705259},{"x":0.6099999863654375,"y":3.295188212967093},{"x":0.6199999861419201,"y":3.264005315350365},{"x":0.6299999859184027,"y":3.2121762429610263},{"x":0.6399999856948853,"y":3.140211148467896},{"x":0.6499999854713678,"y":3.048965857658115},{"x":0.6599999852478504,"y":2.939632311074112},{"x":0.669999985024333,"y":2.81372052715202},{"x":0.6799999848008156,"y":2.6730321676456823},{"x":0.6899999845772982,"y":2.519626030188894},{"x":0.6999999843537807,"y":2.3557760458786903},{"x":0.7099999841302633,"y":2.183922615151799},{"x":0.7199999839067459,"y":2.0066183655784995},{"x":0.7299999836832285,"y":1.8264696524162738},{"x":0.7399999834597111,"y":1.646075338177148},{"x":0.7499999832361937,"y":1.4679645719754402},{"x":0.7599999830126762,"y":1.294535433720603},{"x":0.7699999827891588,"y":1.1279964029972445},{"x":0.7799999825656414,"y":0.9703126487110759},{"x":0.789999982342124,"y":0.8231591048669121},{"x":0.7999999821186066,"y":0.6878821927577803},{"x":0.8099999818950891,"y":0.5654718643676755},{"x":0.8199999816715717,"y":0.4565453718047589},{"x":0.8299999814480543,"y":0.36134381140537053},{"x":0.8399999812245369,"y":0.2797420501496224},{"x":0.8499999810010195,"y":0.21127212130032333},{"x":0.8599999807775021,"y":0.15515958528996573},{"x":0.8699999805539846,"y":0.11037170571179913},{"x":0.8799999803304672,"y":0.07567560991153958},{"x":0.8899999801069498,"y":0.04970391742570228},{"x":0.8999999798834324,"y":0.03102466396458799},{"x":0.909999979659915,"y":0.018211769859799987},{"x":0.9199999794363976,"y":0.00991185670768948},{"x":0.9299999792128801,"y":0.004902973297251851},{"x":0.9399999789893627,"y":0.002140834398424133},{"x":0.9499999787658453,"y":7.88601424709937E-4},{"x":0.9599999785423279,"y":2.27157154733626E-4},{"x":0.9699999783188105,"y":4.438119553507503E-5},{"x":0.979999978095293,"y":4.273084551147905E-6},{"x":0.9899999778717756,"y":7.315541773450082E-8},{"x":0.9999999776482582,"y":9.986014857106299E-42}]},{"name":"6c208259-cc6d-4104-9fdf-830c17070dd3","values":[{"x":0.0,"y":0},{"x":0.06666666666666668,"y":0.0},{"x":0.13333333333333336,"y":0.0},{"x":0.20000000000000004,"y":0.0},{"x":0.2666666666666667,"y":0.0},{"x":0.33333333333333337,"y":0.0},{"x":0.4,"y":0.567},{"x":0.4666666666666667,"y":2.562},{"x":0.5333333333333333,"y":4.475999999999999},{"x":0.6,"y":3.0494999999999997},{"x":0.6666666666666666,"y":3.5039999999999996},{"x":0.7333333333333333,"y":0.8414999999999999},{"x":0.7999999999999999,"y":0.0},{"x":0.8666666666666666,"y":0.0},{"x":0.9333333333333332,"y":0.0},{"x":0.9999999999999999,"y":0.0},{"x":1.0666666666666667,"y":0.0},{"x":1.1333333333333333,"y":0}]}],"marks":[{"type":"line","from":{"data":"3d8f9732-0260-4187-ae70-2895b47c6b91"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"stroke":{"value":"#FF29D2"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}},{"type":"line","from":{"data":"6c208259-cc6d-4104-9fdf-830c17070dd3"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"interpolate":{"value":"step-before"},"fill":{"value":"steelblue"},"fillOpacity":{"value":0.4},"stroke":{"value":"steelblue"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:top 10, :left 55, :bottom 40, :right 10}, :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"3d8f9732-0260-4187-ae70-2895b47c6b91\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"3d8f9732-0260-4187-ae70-2895b47c6b91\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}], :data ({:name \"3d8f9732-0260-4187-ae70-2895b47c6b91\", :values ({:x 0, :y 0.0} {:x 0.009999999776482582, :y 7.539371529953434E-14} {:x 0.019999999552965164, :y 3.632038081710175E-11} {:x 0.029999999329447746, :y 1.312942410206015E-9} {:x 0.03999999910593033, :y 1.6432033048666994E-8} {:x 0.04999999888241291, :y 1.149729437009842E-7} {:x 0.05999999865889549, :y 5.567399112490165E-7} {:x 0.06999999843537807, :y 2.0907592791841455E-6} {:x 0.07999999821186066, :y 6.517196703563322E-6} {:x 0.08999999798834324, :y 1.7617931689323155E-5} {:x 0.09999999776482582, :y 4.2557787352993526E-5} {:x 0.1099999975413084, :y 9.384220214797907E-5} {:x 0.11999999731779099, :y 1.9188950934436485E-4} {:x 0.12999999709427357, :y 3.6823890654172673E-4} {:x 0.13999999687075615, :y 6.69371188358415E-4} {:x 0.14999999664723873, :y 0.0011610712548425525} {:x 0.1599999964237213, :y 0.00193321229472357} {:x 0.1699999962002039, :y 0.0031047943233924453} {:x 0.17999999597668648, :y 0.004829027183399602} {:x 0.18999999575316906, :y 0.007298212637337675} {:x 0.19999999552965164, :y 0.010748153856440106} {:x 0.20999999530613422, :y 0.015461805041620348} {:x 0.2199999950826168, :y 0.021771870230572168} {:x 0.2299999948590994, :y 0.030062069167227316} {:x 0.23999999463558197, :y 0.040766809560579466} {:x 0.24999999441206455, :y 0.05436903877742644} {:x 0.25999999418854713, :y 0.0713960931829195} {:x 0.2699999939650297, :y 0.09241341873570566} {:x 0.2799999937415123, :y 0.11801610046911065} {:x 0.2899999935179949, :y 0.14881820924762124} {:x 0.29999999329447746, :y 0.18544004953551946} {:x 0.30999999307096004, :y 0.2284934695295775} {:x 0.3199999928474426, :y 0.27856547245668084} {:x 0.3299999926239252, :y 0.33620044264396637} {:x 0.3399999924004078, :y 0.4018813696822282} {:x 0.3499999921768904, :y 0.4760105162626121} {:x 0.35999999195337296, :y 0.5588900278646792} {:x 0.36999999172985554, :y 0.6507030234154363} {:x 0.3799999915063381, :y 0.7514957335932372} {:x 0.3899999912828207, :y 0.8611612661993497} {:x 0.3999999910593033, :y 0.9794255748977719} {:x 0.40999999083578587, :y 1.1058361879511303} {:x 0.41999999061226845, :y 1.2397542170890021} {:x 0.42999999038875103, :y 1.3803501134949525} {:x 0.4399999901652336, :y 1.5266035686874704} {:x 0.4499999899417162, :y 1.6773078738314677} {:x 0.4599999897181988, :y 1.831078953212661} {:x 0.46999998949468136, :y 1.9863691781078412} {:x 0.47999998927116394, :y 2.1414859483424555} {:x 0.4899999890476465, :y 2.294614903043911} {:x 0.4999999888241291, :y 2.443847492377241} {:x 0.5099999886006117, :y 2.587212511544168} {:x 0.5199999883770943, :y 2.7227110703849355} {:x 0.5299999881535769, :y 2.8483543500177806} {:x 0.5399999879300594, :y 2.9622033856139547} {:x 0.549999987706542, :y 3.062410015143814} {:x 0.5599999874830246, :y 3.1472580511471233} {:x 0.5699999872595072, :y 3.2152036694964807} {:x 0.5799999870359898, :y 3.2649139686831417} {:x 0.5899999868124723, :y 3.2953026379436374} {:x 0.5999999865889549, :y 3.305561684705259} {:x 0.6099999863654375, :y 3.295188212967093} {:x 0.6199999861419201, :y 3.264005315350365} {:x 0.6299999859184027, :y 3.2121762429610263} {:x 0.6399999856948853, :y 3.140211148467896} {:x 0.6499999854713678, :y 3.048965857658115} {:x 0.6599999852478504, :y 2.939632311074112} {:x 0.669999985024333, :y 2.81372052715202} {:x 0.6799999848008156, :y 2.6730321676456823} {:x 0.6899999845772982, :y 2.519626030188894} {:x 0.6999999843537807, :y 2.3557760458786903} {:x 0.7099999841302633, :y 2.183922615151799} {:x 0.7199999839067459, :y 2.0066183655784995} {:x 0.7299999836832285, :y 1.8264696524162738} {:x 0.7399999834597111, :y 1.646075338177148} {:x 0.7499999832361937, :y 1.4679645719754402} {:x 0.7599999830126762, :y 1.294535433720603} {:x 0.7699999827891588, :y 1.1279964029972445} {:x 0.7799999825656414, :y 0.9703126487110759} {:x 0.789999982342124, :y 0.8231591048669121} {:x 0.7999999821186066, :y 0.6878821927577803} {:x 0.8099999818950891, :y 0.5654718643676755} {:x 0.8199999816715717, :y 0.4565453718047589} {:x 0.8299999814480543, :y 0.36134381140537053} {:x 0.8399999812245369, :y 0.2797420501496224} {:x 0.8499999810010195, :y 0.21127212130032333} {:x 0.8599999807775021, :y 0.15515958528996573} {:x 0.8699999805539846, :y 0.11037170571179913} {:x 0.8799999803304672, :y 0.07567560991153958} {:x 0.8899999801069498, :y 0.04970391742570228} {:x 0.8999999798834324, :y 0.03102466396458799} {:x 0.909999979659915, :y 0.018211769859799987} {:x 0.9199999794363976, :y 0.00991185670768948} {:x 0.9299999792128801, :y 0.004902973297251851} {:x 0.9399999789893627, :y 0.002140834398424133} {:x 0.9499999787658453, :y 7.88601424709937E-4} {:x 0.9599999785423279, :y 2.27157154733626E-4} {:x 0.9699999783188105, :y 4.438119553507503E-5} {:x 0.979999978095293, :y 4.273084551147905E-6} {:x 0.9899999778717756, :y 7.315541773450082E-8} {:x 0.9999999776482582, :y 9.986014857106299E-42})} {:name \"6c208259-cc6d-4104-9fdf-830c17070dd3\", :values ({:x 0.0, :y 0} {:x 0.06666666666666668, :y 0.0} {:x 0.13333333333333336, :y 0.0} {:x 0.20000000000000004, :y 0.0} {:x 0.2666666666666667, :y 0.0} {:x 0.33333333333333337, :y 0.0} {:x 0.4, :y 0.567} {:x 0.4666666666666667, :y 2.562} {:x 0.5333333333333333, :y 4.475999999999999} {:x 0.6, :y 3.0494999999999997} {:x 0.6666666666666666, :y 3.5039999999999996} {:x 0.7333333333333333, :y 0.8414999999999999} {:x 0.7999999999999999, :y 0.0} {:x 0.8666666666666666, :y 0.0} {:x 0.9333333333333332, :y 0.0} {:x 0.9999999999999999, :y 0.0} {:x 1.0666666666666667, :y 0.0} {:x 1.1333333333333333, :y 0})}), :marks ({:type \"line\", :from {:data \"3d8f9732-0260-4187-ae70-2895b47c6b91\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :stroke {:value \"#FF29D2\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}} {:type \"line\", :from {:data \"6c208259-cc6d-4104-9fdf-830c17070dd3\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :interpolate {:value \"step-before\"}, :fill {:value \"steelblue\"}, :fillOpacity {:value 0.4}, :stroke {:value \"steelblue\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}})}}"}
;; <=

;; @@
(def num-particles 20)
(def is-states (take num-particles (infer :importance beta-flip [test-observations])))
(plt/compose
  posterior-plot
  (plt/histogram (repeatedly 10000 #(sample* (categorical (vec (stat/empirical-distribution (stat/collect-results is-states)))))) :plot-range [[0 1] :all] :normalize :probability-density))
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"top":10,"left":55,"bottom":40,"right":10},"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"3d8f9732-0260-4187-ae70-2895b47c6b91","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"3d8f9732-0260-4187-ae70-2895b47c6b91","field":"data.y"}}],"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}],"data":[{"name":"3d8f9732-0260-4187-ae70-2895b47c6b91","values":[{"x":0,"y":0.0},{"x":0.009999999776482582,"y":7.539371529953434E-14},{"x":0.019999999552965164,"y":3.632038081710175E-11},{"x":0.029999999329447746,"y":1.312942410206015E-9},{"x":0.03999999910593033,"y":1.6432033048666994E-8},{"x":0.04999999888241291,"y":1.149729437009842E-7},{"x":0.05999999865889549,"y":5.567399112490165E-7},{"x":0.06999999843537807,"y":2.0907592791841455E-6},{"x":0.07999999821186066,"y":6.517196703563322E-6},{"x":0.08999999798834324,"y":1.7617931689323155E-5},{"x":0.09999999776482582,"y":4.2557787352993526E-5},{"x":0.1099999975413084,"y":9.384220214797907E-5},{"x":0.11999999731779099,"y":1.9188950934436485E-4},{"x":0.12999999709427357,"y":3.6823890654172673E-4},{"x":0.13999999687075615,"y":6.69371188358415E-4},{"x":0.14999999664723873,"y":0.0011610712548425525},{"x":0.1599999964237213,"y":0.00193321229472357},{"x":0.1699999962002039,"y":0.0031047943233924453},{"x":0.17999999597668648,"y":0.004829027183399602},{"x":0.18999999575316906,"y":0.007298212637337675},{"x":0.19999999552965164,"y":0.010748153856440106},{"x":0.20999999530613422,"y":0.015461805041620348},{"x":0.2199999950826168,"y":0.021771870230572168},{"x":0.2299999948590994,"y":0.030062069167227316},{"x":0.23999999463558197,"y":0.040766809560579466},{"x":0.24999999441206455,"y":0.05436903877742644},{"x":0.25999999418854713,"y":0.0713960931829195},{"x":0.2699999939650297,"y":0.09241341873570566},{"x":0.2799999937415123,"y":0.11801610046911065},{"x":0.2899999935179949,"y":0.14881820924762124},{"x":0.29999999329447746,"y":0.18544004953551946},{"x":0.30999999307096004,"y":0.2284934695295775},{"x":0.3199999928474426,"y":0.27856547245668084},{"x":0.3299999926239252,"y":0.33620044264396637},{"x":0.3399999924004078,"y":0.4018813696822282},{"x":0.3499999921768904,"y":0.4760105162626121},{"x":0.35999999195337296,"y":0.5588900278646792},{"x":0.36999999172985554,"y":0.6507030234154363},{"x":0.3799999915063381,"y":0.7514957335932372},{"x":0.3899999912828207,"y":0.8611612661993497},{"x":0.3999999910593033,"y":0.9794255748977719},{"x":0.40999999083578587,"y":1.1058361879511303},{"x":0.41999999061226845,"y":1.2397542170890021},{"x":0.42999999038875103,"y":1.3803501134949525},{"x":0.4399999901652336,"y":1.5266035686874704},{"x":0.4499999899417162,"y":1.6773078738314677},{"x":0.4599999897181988,"y":1.831078953212661},{"x":0.46999998949468136,"y":1.9863691781078412},{"x":0.47999998927116394,"y":2.1414859483424555},{"x":0.4899999890476465,"y":2.294614903043911},{"x":0.4999999888241291,"y":2.443847492377241},{"x":0.5099999886006117,"y":2.587212511544168},{"x":0.5199999883770943,"y":2.7227110703849355},{"x":0.5299999881535769,"y":2.8483543500177806},{"x":0.5399999879300594,"y":2.9622033856139547},{"x":0.549999987706542,"y":3.062410015143814},{"x":0.5599999874830246,"y":3.1472580511471233},{"x":0.5699999872595072,"y":3.2152036694964807},{"x":0.5799999870359898,"y":3.2649139686831417},{"x":0.5899999868124723,"y":3.2953026379436374},{"x":0.5999999865889549,"y":3.305561684705259},{"x":0.6099999863654375,"y":3.295188212967093},{"x":0.6199999861419201,"y":3.264005315350365},{"x":0.6299999859184027,"y":3.2121762429610263},{"x":0.6399999856948853,"y":3.140211148467896},{"x":0.6499999854713678,"y":3.048965857658115},{"x":0.6599999852478504,"y":2.939632311074112},{"x":0.669999985024333,"y":2.81372052715202},{"x":0.6799999848008156,"y":2.6730321676456823},{"x":0.6899999845772982,"y":2.519626030188894},{"x":0.6999999843537807,"y":2.3557760458786903},{"x":0.7099999841302633,"y":2.183922615151799},{"x":0.7199999839067459,"y":2.0066183655784995},{"x":0.7299999836832285,"y":1.8264696524162738},{"x":0.7399999834597111,"y":1.646075338177148},{"x":0.7499999832361937,"y":1.4679645719754402},{"x":0.7599999830126762,"y":1.294535433720603},{"x":0.7699999827891588,"y":1.1279964029972445},{"x":0.7799999825656414,"y":0.9703126487110759},{"x":0.789999982342124,"y":0.8231591048669121},{"x":0.7999999821186066,"y":0.6878821927577803},{"x":0.8099999818950891,"y":0.5654718643676755},{"x":0.8199999816715717,"y":0.4565453718047589},{"x":0.8299999814480543,"y":0.36134381140537053},{"x":0.8399999812245369,"y":0.2797420501496224},{"x":0.8499999810010195,"y":0.21127212130032333},{"x":0.8599999807775021,"y":0.15515958528996573},{"x":0.8699999805539846,"y":0.11037170571179913},{"x":0.8799999803304672,"y":0.07567560991153958},{"x":0.8899999801069498,"y":0.04970391742570228},{"x":0.8999999798834324,"y":0.03102466396458799},{"x":0.909999979659915,"y":0.018211769859799987},{"x":0.9199999794363976,"y":0.00991185670768948},{"x":0.9299999792128801,"y":0.004902973297251851},{"x":0.9399999789893627,"y":0.002140834398424133},{"x":0.9499999787658453,"y":7.88601424709937E-4},{"x":0.9599999785423279,"y":2.27157154733626E-4},{"x":0.9699999783188105,"y":4.438119553507503E-5},{"x":0.979999978095293,"y":4.273084551147905E-6},{"x":0.9899999778717756,"y":7.315541773450082E-8},{"x":0.9999999776482582,"y":9.986014857106299E-42}]},{"name":"02a315b7-93d3-452f-8571-9531f4cb76de","values":[{"x":0.0,"y":0},{"x":0.06666666666666668,"y":0.0},{"x":0.13333333333333336,"y":0.0},{"x":0.20000000000000004,"y":0.0014999999999999998},{"x":0.2666666666666667,"y":0.036},{"x":0.33333333333333337,"y":0.4724999999999999},{"x":0.4,"y":1.0514999999999999},{"x":0.4666666666666667,"y":1.4084999999999999},{"x":0.5333333333333333,"y":0.0},{"x":0.6,"y":4.451999999999999},{"x":0.6666666666666666,"y":7.577999999999999},{"x":0.7333333333333333,"y":0.0},{"x":0.7999999999999999,"y":0.0},{"x":0.8666666666666666,"y":0.0},{"x":0.9333333333333332,"y":0.0},{"x":0.9999999999999999,"y":0.0},{"x":1.0666666666666667,"y":0.0},{"x":1.1333333333333333,"y":0}]}],"marks":[{"type":"line","from":{"data":"3d8f9732-0260-4187-ae70-2895b47c6b91"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"stroke":{"value":"#FF29D2"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}},{"type":"line","from":{"data":"02a315b7-93d3-452f-8571-9531f4cb76de"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"interpolate":{"value":"step-before"},"fill":{"value":"steelblue"},"fillOpacity":{"value":0.4},"stroke":{"value":"steelblue"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:top 10, :left 55, :bottom 40, :right 10}, :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"3d8f9732-0260-4187-ae70-2895b47c6b91\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"3d8f9732-0260-4187-ae70-2895b47c6b91\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}], :data ({:name \"3d8f9732-0260-4187-ae70-2895b47c6b91\", :values ({:x 0, :y 0.0} {:x 0.009999999776482582, :y 7.539371529953434E-14} {:x 0.019999999552965164, :y 3.632038081710175E-11} {:x 0.029999999329447746, :y 1.312942410206015E-9} {:x 0.03999999910593033, :y 1.6432033048666994E-8} {:x 0.04999999888241291, :y 1.149729437009842E-7} {:x 0.05999999865889549, :y 5.567399112490165E-7} {:x 0.06999999843537807, :y 2.0907592791841455E-6} {:x 0.07999999821186066, :y 6.517196703563322E-6} {:x 0.08999999798834324, :y 1.7617931689323155E-5} {:x 0.09999999776482582, :y 4.2557787352993526E-5} {:x 0.1099999975413084, :y 9.384220214797907E-5} {:x 0.11999999731779099, :y 1.9188950934436485E-4} {:x 0.12999999709427357, :y 3.6823890654172673E-4} {:x 0.13999999687075615, :y 6.69371188358415E-4} {:x 0.14999999664723873, :y 0.0011610712548425525} {:x 0.1599999964237213, :y 0.00193321229472357} {:x 0.1699999962002039, :y 0.0031047943233924453} {:x 0.17999999597668648, :y 0.004829027183399602} {:x 0.18999999575316906, :y 0.007298212637337675} {:x 0.19999999552965164, :y 0.010748153856440106} {:x 0.20999999530613422, :y 0.015461805041620348} {:x 0.2199999950826168, :y 0.021771870230572168} {:x 0.2299999948590994, :y 0.030062069167227316} {:x 0.23999999463558197, :y 0.040766809560579466} {:x 0.24999999441206455, :y 0.05436903877742644} {:x 0.25999999418854713, :y 0.0713960931829195} {:x 0.2699999939650297, :y 0.09241341873570566} {:x 0.2799999937415123, :y 0.11801610046911065} {:x 0.2899999935179949, :y 0.14881820924762124} {:x 0.29999999329447746, :y 0.18544004953551946} {:x 0.30999999307096004, :y 0.2284934695295775} {:x 0.3199999928474426, :y 0.27856547245668084} {:x 0.3299999926239252, :y 0.33620044264396637} {:x 0.3399999924004078, :y 0.4018813696822282} {:x 0.3499999921768904, :y 0.4760105162626121} {:x 0.35999999195337296, :y 0.5588900278646792} {:x 0.36999999172985554, :y 0.6507030234154363} {:x 0.3799999915063381, :y 0.7514957335932372} {:x 0.3899999912828207, :y 0.8611612661993497} {:x 0.3999999910593033, :y 0.9794255748977719} {:x 0.40999999083578587, :y 1.1058361879511303} {:x 0.41999999061226845, :y 1.2397542170890021} {:x 0.42999999038875103, :y 1.3803501134949525} {:x 0.4399999901652336, :y 1.5266035686874704} {:x 0.4499999899417162, :y 1.6773078738314677} {:x 0.4599999897181988, :y 1.831078953212661} {:x 0.46999998949468136, :y 1.9863691781078412} {:x 0.47999998927116394, :y 2.1414859483424555} {:x 0.4899999890476465, :y 2.294614903043911} {:x 0.4999999888241291, :y 2.443847492377241} {:x 0.5099999886006117, :y 2.587212511544168} {:x 0.5199999883770943, :y 2.7227110703849355} {:x 0.5299999881535769, :y 2.8483543500177806} {:x 0.5399999879300594, :y 2.9622033856139547} {:x 0.549999987706542, :y 3.062410015143814} {:x 0.5599999874830246, :y 3.1472580511471233} {:x 0.5699999872595072, :y 3.2152036694964807} {:x 0.5799999870359898, :y 3.2649139686831417} {:x 0.5899999868124723, :y 3.2953026379436374} {:x 0.5999999865889549, :y 3.305561684705259} {:x 0.6099999863654375, :y 3.295188212967093} {:x 0.6199999861419201, :y 3.264005315350365} {:x 0.6299999859184027, :y 3.2121762429610263} {:x 0.6399999856948853, :y 3.140211148467896} {:x 0.6499999854713678, :y 3.048965857658115} {:x 0.6599999852478504, :y 2.939632311074112} {:x 0.669999985024333, :y 2.81372052715202} {:x 0.6799999848008156, :y 2.6730321676456823} {:x 0.6899999845772982, :y 2.519626030188894} {:x 0.6999999843537807, :y 2.3557760458786903} {:x 0.7099999841302633, :y 2.183922615151799} {:x 0.7199999839067459, :y 2.0066183655784995} {:x 0.7299999836832285, :y 1.8264696524162738} {:x 0.7399999834597111, :y 1.646075338177148} {:x 0.7499999832361937, :y 1.4679645719754402} {:x 0.7599999830126762, :y 1.294535433720603} {:x 0.7699999827891588, :y 1.1279964029972445} {:x 0.7799999825656414, :y 0.9703126487110759} {:x 0.789999982342124, :y 0.8231591048669121} {:x 0.7999999821186066, :y 0.6878821927577803} {:x 0.8099999818950891, :y 0.5654718643676755} {:x 0.8199999816715717, :y 0.4565453718047589} {:x 0.8299999814480543, :y 0.36134381140537053} {:x 0.8399999812245369, :y 0.2797420501496224} {:x 0.8499999810010195, :y 0.21127212130032333} {:x 0.8599999807775021, :y 0.15515958528996573} {:x 0.8699999805539846, :y 0.11037170571179913} {:x 0.8799999803304672, :y 0.07567560991153958} {:x 0.8899999801069498, :y 0.04970391742570228} {:x 0.8999999798834324, :y 0.03102466396458799} {:x 0.909999979659915, :y 0.018211769859799987} {:x 0.9199999794363976, :y 0.00991185670768948} {:x 0.9299999792128801, :y 0.004902973297251851} {:x 0.9399999789893627, :y 0.002140834398424133} {:x 0.9499999787658453, :y 7.88601424709937E-4} {:x 0.9599999785423279, :y 2.27157154733626E-4} {:x 0.9699999783188105, :y 4.438119553507503E-5} {:x 0.979999978095293, :y 4.273084551147905E-6} {:x 0.9899999778717756, :y 7.315541773450082E-8} {:x 0.9999999776482582, :y 9.986014857106299E-42})} {:name \"02a315b7-93d3-452f-8571-9531f4cb76de\", :values ({:x 0.0, :y 0} {:x 0.06666666666666668, :y 0.0} {:x 0.13333333333333336, :y 0.0} {:x 0.20000000000000004, :y 0.0014999999999999998} {:x 0.2666666666666667, :y 0.036} {:x 0.33333333333333337, :y 0.4724999999999999} {:x 0.4, :y 1.0514999999999999} {:x 0.4666666666666667, :y 1.4084999999999999} {:x 0.5333333333333333, :y 0.0} {:x 0.6, :y 4.451999999999999} {:x 0.6666666666666666, :y 7.577999999999999} {:x 0.7333333333333333, :y 0.0} {:x 0.7999999999999999, :y 0.0} {:x 0.8666666666666666, :y 0.0} {:x 0.9333333333333332, :y 0.0} {:x 0.9999999999999999, :y 0.0} {:x 1.0666666666666667, :y 0.0} {:x 1.1333333333333333, :y 0})}), :marks ({:type \"line\", :from {:data \"3d8f9732-0260-4187-ae70-2895b47c6b91\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :stroke {:value \"#FF29D2\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}} {:type \"line\", :from {:data \"02a315b7-93d3-452f-8571-9531f4cb76de\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :interpolate {:value \"step-before\"}, :fill {:value \"steelblue\"}, :fillOpacity {:value 0.4}, :stroke {:value \"steelblue\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}})}}"}
;; <=

;; @@

;; @@
